/* --- 1. BIẾN MÀU CHUẨN (Đồng bộ toàn app) --- */
$accent-color: #4361ee;       // Xanh dương
$success-color: #00f2c3;      // Xanh lá
$warning-color: #ff8d72;      // Cam
$danger-color: #fd5d93;       // Hồng/Đỏ
$info-color: #0ea5e9;         // Xanh lơ
$text-primary: #ffffff;
$text-secondary: #d1d1d1;

// Cấu hình nền kính (Đồng bộ với ResidentGlobal)
$glass-bg: rgba(39, 41, 61, 0.75); 
$glass-border: 1px solid rgba(255, 255, 255, 0.1);
$glass-blur: 12px;
$glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);

@mixin glass-panel {
    background: $glass-bg;
    backdrop-filter: blur($glass-blur);
    -webkit-backdrop-filter: blur($glass-blur);
    border: $glass-border;
    box-shadow: $glass-shadow;
    border-radius: 12px; // Chỉnh về 12px cho đồng bộ với Home/Resident
}

.mandatory-dashboard {
    display: flex;
    flex-direction: column;
    gap: 20px; // Giảm khoảng cách chút cho gọn
    color: $text-primary;
    padding-bottom: 30px;
    animation: fadeIn 0.5s ease-out;

    /* --- 1. QUICK ACTIONS (THANH THAO TÁC) --- */
    .quick-actions-panel {
        @include glass-panel;
        padding: 20px;
        
        h3 { 
            margin: 0 0 15px 0; 
            font-size: 0.9rem; 
            color: $text-secondary; 
            text-transform: uppercase; 
            letter-spacing: 1px;
            font-weight: 600;
            opacity: 0.8;
            padding-left: 5px;
            border-left: 3px solid $accent-color; // Điểm nhấn nhỏ bên trái tiêu đề
            line-height: 1;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;

            .btn-action {
                // --- THAY ĐỔI LỚN: CHUYỂN VỀ STYLE NHẸ NHÀNG ---
                padding: 15px;
                border: 1px solid rgba(255, 255, 255, 0.1); // Viền mờ
                background: rgba(255, 255, 255, 0.03);      // Nền tối rất nhạt
                border-radius: 8px;                         // Bo góc nhẹ
                color: $text-secondary;                     // Chữ màu xám sáng
                
                font-weight: 600;
                font-size: 0.95rem;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 10px;
                transition: all 0.2s ease;

                .icon { 
                    font-size: 1.2rem; 
                    transition: transform 0.2s;
                }

                // --- MÀU SẮC CHỈ HIỆN KHI HOVER HOẶC Ở ICON ---
                
                // 1. Nút Tạo khoản thu (Màu Xanh Dương)
                &.create { 
                    .icon { color: $accent-color; } 
                    &:hover { 
                        background: rgba($accent-color, 0.1); 
                        border-color: $accent-color; 
                        color: white;
                        .icon { transform: scale(1.1); }
                    }
                }
                
                // 2. Nút Thu phí (Màu Xanh Lá)
                &.collect { 
                    .icon { color: $success-color; }
                    &:hover { 
                        background: rgba($success-color, 0.1); 
                        border-color: $success-color; 
                        color: white;
                        .icon { transform: scale(1.1); }
                    }
                }
                
                // 3. Nút Xem danh sách (Màu Xanh Lơ)
                &.list { 
                    .icon { color: $info-color; }
                    &:hover { 
                        background: rgba($info-color, 0.1); 
                        border-color: $info-color; 
                        color: white;
                        .icon { transform: scale(1.1); }
                    }
                }

                &:active { transform: scale(0.98); }
            }
        }
    }

    /* --- 2. KPI CARDS (Hàng chỉ số) --- */
    .kpi-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;

        .kpi-card {
            @include glass-panel;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            
            // Thêm hiệu ứng hover nhẹ
            transition: transform 0.2s, background 0.2s;
            &:hover {
                transform: translateY(-2px);
                background: rgba(39, 41, 61, 0.85); // Đậm hơn chút khi hover
            }

            h4 { 
                margin: 0 0 10px 0; 
                font-size: 0.8rem; 
                color: $text-secondary; 
                text-transform: uppercase; 
                letter-spacing: 0.5px;
            }
            
            .value { 
                font-size: 1.8rem; 
                font-weight: 700; 
                margin-bottom: 5px;
            }
            
            .sub-text { 
                font-size: 0.8rem; 
                opacity: 0.6; 
                font-style: italic;
            }

            // Giữ nguyên logic màu chữ
            &.blue .value { color: $accent-color; }
            &.green .value { color: $success-color; }
            &.red .value { color: $danger-color; }
        }
    }

    /* --- 3. CHARTS GRID (Biểu đồ) --- */
    .charts-grid {
        display: grid;
        grid-template-columns: 2fr 1fr 1.2fr; 
        gap: 20px;
        min-height: 400px;

        .chart-panel, .debt-list-panel {
            @include glass-panel;
            padding: 20px;
            display: flex;
            flex-direction: column;

            h4 { 
                margin: 0 0 15px 0; 
                font-size: 0.95rem; 
                font-weight: 600; 
                color: $text-primary;
                border-bottom: 1px solid rgba(255,255,255,0.05);
                padding-bottom: 10px;
            }
        }

        .chart-wrapper {
            flex-grow: 1;
            position: relative;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* --- Style Danh sách nợ --- */
        .debt-list-panel {
            h4 { color: $warning-color; } // Màu cam cảnh báo

            ul {
                list-style: none;
                padding: 0;
                margin: 0;
                overflow-y: auto;
                flex-grow: 1;
                
                &::-webkit-scrollbar { width: 4px; }
                &::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 2px; }

                li {
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-start; // Căn hàng trên cùng
                    padding: 12px 5px;
                    border-bottom: 1px solid rgba(255,255,255,0.05);
                    transition: background 0.2s;

                    &:hover { background: rgba(255,255,255,0.02); }
                    &:last-child { border-bottom: none; }

                    .room-info {
                        display: flex;
                        flex-direction: column;
                        gap: 2px;
                        
                        .room { 
                            font-weight: 600; 
                            font-size: 1rem; 
                            color: $text-primary; 
                        }
                        .month-badge { 
                            font-size: 0.75rem; 
                            color: $text-secondary;
                            background: rgba(255,255,255,0.05);
                            padding: 2px 6px;
                            border-radius: 4px;
                            display: inline-block;
                        }
                    }
                    .amount {
                        color: $danger-color;
                        font-weight: 700;
                        font-size: 1rem;
                    }
                }
            }
        }
    }
}

// Animation
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* --- RESPONSIVE --- */
@media (max-width: 1200px) {
    .charts-grid {
        grid-template-columns: 1fr 1fr; 
        .chart-panel:first-child { grid-column: span 2; }
    }
}

@media (max-width: 768px) {
    .quick-actions-panel .action-buttons { grid-template-columns: 1fr; }
    .kpi-grid { grid-template-columns: 1fr; }
    .charts-grid { grid-template-columns: 1fr; .chart-panel:first-child { grid-column: span 1; } }
}