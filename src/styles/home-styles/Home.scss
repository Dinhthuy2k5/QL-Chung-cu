// --- BIẾN MÀU SẮC (Đồng bộ với ResidentGlobal) ---
$accent-color: #4361ee;       // Xanh chủ đạo
$text-primary: #ffffff;       // Chữ trắng
$text-secondary: #d1d1d1;     // Chữ xám nhạt
$success-color: #00f2c3;
$warning-color: #ff8d72;
$danger-color: #fd5d93;

// --- CẤU HÌNH NỀN KÍNH (DARK GLASS) ---
$glass-bg: rgba(39, 41, 61, 0.75); 
$glass-border: 1px solid rgba(255, 255, 255, 0.1);
$glass-blur: 12px;
$glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);

// --- MIXIN DÙNG CHUNG ---
@mixin glass-panel {
    background: $glass-bg;
    backdrop-filter: blur($glass-blur);
    -webkit-backdrop-filter: blur($glass-blur);
    border: $glass-border;
    box-shadow: $glass-shadow;
    border-radius: 12px;
}

// --- Gradients cho Icon (Giữ nguyên của bạn) ---
$blue-grad: linear-gradient(to bottom right, #007bff, #0056b3);
$green-grad: linear-gradient(to bottom right, #28a745, #218838);
$purple-grad: linear-gradient(to bottom right, #6f42c1, #59359a);
$orange-grad: linear-gradient(to bottom right, #fd7e14, #d66203);

.home-dashboard {
    padding: 30px;
    max-width: 1400px;
    margin: 0 auto;
    color: $text-primary;
    font-family: 'Inter', sans-serif;
    // QUAN TRỌNG: Nền trong suốt để lộ hình nền động phía sau
    background-color: transparent; 
}

// --- 1. STAT CARDS MINI (Hàng trên cùng) ---
.dashboard-stats-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
    margin-bottom: 25px;
}

.stat-card-mini {
    // Thay màu nền cũ bằng hiệu ứng kính
    @include glass-panel;
    
    padding: 20px;
    display: flex;
    align-items: center;
    position: relative;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    
    // Ghi đè border của mixin để tạo hiệu ứng hover đẹp hơn
    border: 1px solid rgba(255, 255, 255, 0.1); 

    &:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.4);
        background: rgba(39, 41, 61, 0.9); // Đậm hơn khi hover
        border-color: $accent-color; // Viền sáng lên
        
        .card-arrow { opacity: 1; transform: translateX(0); }
    }

    .card-icon-wrapper {
        width: 50px;
        height: 50px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 15px;
        font-size: 1.5rem;
        color: white; // Icon màu trắng trên nền gradient
        box-shadow: 0 4px 10px rgba(0,0,0,0.3);

        &.blue { background: $blue-grad; }
        &.green { background: $green-grad; }
        &.purple { background: $purple-grad; }
        &.orange { background: $orange-grad; }
    }

    .card-content {
        flex-grow: 1;
        .card-title {
            margin: 0;
            font-size: 0.85rem;
            color: $text-secondary;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        .card-count {
            margin: 5px 0 0 0;
            font-size: 1.8rem; // Tăng nhẹ cỡ chữ số
            font-weight: 700;
            color: $text-primary;
        }
    }

    .card-arrow {
        opacity: 0;
        transform: translateX(-10px);
        transition: all 0.3s;
        color: $text-secondary;
        font-size: 1.2rem;
    }
}

// --- 2. MAIN CONTENT GRID ---
.dashboard-main-content {
    display: grid;
    grid-template-columns: 2fr 1fr; // Tỷ lệ 2:1
    gap: 25px;
    height: 500px; 

    @media (max-width: 992px) {
        grid-template-columns: 1fr;
        height: auto;
    }
}

// Class chung cho các panel lớn (Chart, Activity)
.dashboard-panel {
    @include glass-panel; // Áp dụng nền kính
    padding: 20px;
    display: flex;
    flex-direction: column;
    // Bỏ background cũ đi vì đã dùng mixin
}

// --- 3. BIỂU ĐỒ (CHART PANEL) ---
.chart-panel {
    @extend .dashboard-panel; // Kế thừa style chung

    .panel-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;

        h4 { 
            margin: 0; 
            font-size: 1.1rem; 
            font-weight: 700; 
            color: $text-primary; 
        }
        .sub-text { 
            margin: 5px 0 0 0; 
            font-size: 0.85rem; 
            color: $text-secondary; 
        }
        
        .chart-legend {
            font-size: 0.85rem;
            color: $text-secondary;
            display: flex;
            align-items: center;
            .dot { width: 10px; height: 10px; background: $accent-color; border-radius: 50%; margin-right: 5px; }
        }
    }

    .chart-wrapper {
        flex-grow: 1;
        position: relative;
        width: 100%;
        min-height: 0; 
    }

    .loading-state {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        color: $text-secondary;
        font-style: italic;
    }
}

// --- 4. HOẠT ĐỘNG (ACTIVITY PANEL) ---
.activity-panel {
    @include glass-panel; // Áp dụng nền kính
    padding: 0; // Reset padding để tabs dính sát lề
    overflow: hidden;
    display: flex;
    flex-direction: column;

    .panel-header-tabs {
        display: flex;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1); // Viền mờ
        background: rgba(0, 0, 0, 0.2); // Nền header tối hơn chút

        .tab-btn {
            flex: 1;
            padding: 15px;
            background: transparent;
            border: none;
            color: $text-secondary;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;

            &:hover { 
                color: $text-primary; 
                background: rgba(255, 255, 255, 0.05); 
            }

            &.active {
                color: $accent-color; // Màu xanh sáng
                border-bottom-color: $accent-color;
                background: rgba(67, 97, 238, 0.1); // Nền xanh nhạt
            }
        }
    }

    .list-wrapper {
        padding: 10px 20px;
        overflow-y: auto;
        height: 100%;

        // Scrollbar đẹp
        &::-webkit-scrollbar { width: 6px; }
        &::-webkit-scrollbar-track { background: transparent; }
        &::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 3px; }
    }

    .activity-list {
        list-style: none;
        padding: 0;
        margin: 0;
        
        .activity-item {
            display: flex;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05); // Viền mờ ngăn cách
            
            &:last-child { border-bottom: none; }

            // Icon tròn bên trái
            .activity-icon {
                width: 36px;
                height: 36px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                margin-right: 15px;
                flex-shrink: 0;
                font-size: 1.2rem;
                
                // Màu nền mặc định cho icon (trong suốt hơn)
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid rgba(255, 255, 255, 0.1);

                &.res { background: rgba(40, 167, 69, 0.15); border-color: rgba(40, 167, 69, 0.3); color: $success-color; }
                &.fee { background: rgba(67, 97, 238, 0.15); border-color: rgba(67, 97, 238, 0.3); color: $accent-color; }
            }

            .activity-content {
                flex-grow: 1;
                
                .activity-type-badge {
                    display: inline-block;
                    font-size: 0.7rem;
                    font-weight: bold;
                    padding: 2px 8px;
                    border-radius: 4px;
                    margin-bottom: 5px;
                    text-transform: capitalize;
                    
                    // --- ĐỊNH NGHĨA MÀU CHO CÁC LOẠI (Dùng biến màu chuẩn) ---
                     &.thêm-nhân-khẩu { background: rgba(0, 242, 195, 0.15); color: $success-color; border: 1px solid rgba(0, 242, 195, 0.3); }
                    &.xóa-nhân-khẩu { background: rgba(255, 141, 114, 0.15); color: $warning-color; border: 1px solid rgba(255, 141, 114, 0.3); }
                    &.thêm-mới { background: rgba(23, 162, 184, 0.15); color: #17a2b8; border: 1px solid rgba(23, 162, 184, 0.3); }
                    &.tạm-trú { background: rgba(0, 242, 195, 0.15); color: $success-color; border: 1px solid rgba(0, 242, 195, 0.3); }
                    &.tạm-vắng { background: rgba(255, 141, 114, 0.15); color: $warning-color; border: 1px solid rgba(255, 141, 114, 0.3); }
                    &.thêm-mới { background: rgba(23, 162, 184, 0.15); color: #17a2b8; border: 1px solid rgba(23, 162, 184, 0.3); }
                    &.thu-phí { background: rgba(67, 97, 238, 0.15); color: $accent-color; border: 1px solid rgba(67, 97, 238, 0.3); }
                    &.đóng-góp { background: rgba(253, 93, 147, 0.15); color: $danger-color; border: 1px solid rgba(253, 93, 147, 0.3); }
                }

                .activity-msg {
                    margin: 0;
                    font-size: 0.9rem;
                    line-height: 1.4;
                    color: $text-primary; // Chữ trắng sáng
                }

                .activity-time {
                    display: block;
                    font-size: 0.75rem;
                    color: $text-secondary; // Chữ xám nhạt
                    margin-top: 5px;
                }
            }
        }
    }

    .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100%;
        color: $text-secondary;
        opacity: 0.6;
        
        img { margin-bottom: 10px; filter: grayscale(100%); }
    }
}