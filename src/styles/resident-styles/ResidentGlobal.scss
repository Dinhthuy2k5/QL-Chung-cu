/* --- CẤU HÌNH CƠ BẢN (QUAN TRỌNG) --- */
* {
    box-sizing: border-box; // Fix lỗi padding làm vỡ khung
}

/* --- BIẾN MÀU SẮC --- */
$accent-color: #4361ee;
$text-primary: #ffffff;
$text-secondary: #d1d1d1;
$success-color: #00f2c3;
$warning-color: #ff8d72;
$danger-color: #fd5d93;

// Cấu hình nền kính
$glass-bg: rgba(39, 41, 61, 0.75);
$glass-border: 1px solid rgba(255, 255, 255, 0.1);
$glass-blur: 12px;
$glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);

@mixin glass-panel {
    background: $glass-bg;
    backdrop-filter: blur($glass-blur);
    -webkit-backdrop-filter: blur($glass-blur);
    border: $glass-border;
    box-shadow: $glass-shadow;
    border-radius: 12px;
}

/* --- 1. LAYOUT CHUNG --- */
.resident-page-wrapper {
    width: 100%;
    // Giới hạn chiều rộng để bảng không bị to quá khổ trên màn hình lớn
    max-width: 1400px; 
    margin: 0 auto; // Căn giữa nội dung
    min-height: 100vh;
    padding: 20px 30px;
    color: $text-primary;
    background-color: transparent;
    font-family: 'Segoe UI', sans-serif;
    animation: fadeIn 0.5s ease-out;
    
    // Ngăn chặn scroll ngang của cả trang
    overflow-x: hidden; 
}

.list-resident-container, 
.family-list-container {
    width: 100%;
    background-color: transparent;
}

/* --- 2. HEADER & NAVIGATION --- */
.resident-header {
    margin-bottom: 25px;
    h2 {
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 20px;
        text-shadow: 0 2px 4px rgba(0,0,0,0.6);
        text-transform: uppercase;
    }
}

.resident-nav-tabs {
    display: flex;
    flex-wrap: wrap; // Cho phép xuống dòng nếu màn hình quá nhỏ
    gap: 10px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.15);
    padding-bottom: 10px;
    margin-bottom: 20px;

    .nav-item {
        position: relative; // Quan trọng: để dropdown định vị theo thẻ này
        height: 100%;       // Đảm bảo chiều cao nút bao trùm
        display: flex;
        align-items: center;
        text-decoration: none;
        color: $text-secondary;
        font-weight: 600;
        font-size: 0.95rem;
        padding: 8px 16px;
        border-radius: 8px;
        transition: all 0.2s ease;
        position: relative;
        white-space: nowrap; // Giữ text menu trên 1 dòng

        &:hover {
            color: $text-primary;
            background-color: rgba(255, 255, 255, 0.1);
        }

        &.active {
            background-color: $accent-color;
            color: white;
            box-shadow: 0 4px 10px rgba($accent-color, 0.4);
        }
    }

    .nav-dropdown {
        position: absolute;
        top: 100%;
        left: 0;
        // margin-top: 8px; // Xóa dòng này vì bên dưới đã có margin-top: 10px rồi
        min-width: 200px;
        // background-color: white; // Xóa dòng này nếu muốn dùng glass-panel, hoặc giữ lại nếu muốn nền trắng
        
        // z-index: 100; // Xóa dòng này vì bị trùng, dùng 1000 ở dưới là đủ
        // border-radius: 4px; // Xóa dòng này vì glass-panel đã có radius 12px

        z-index: 1000;
        display: flex;
        flex-direction: column;
        
        // --- QUAN TRỌNG: XÓA DÒNG overflow: hidden ĐI ---
        // overflow: hidden; 
        
        @include glass-panel; 

        margin-top: 10px; // Tạo khoảng cách 10px so với menu cha
            
        // Lớp giả tạo cầu nối
        &::before {
            content: "";
            position: absolute;
            // Đẩy lên trên 15px để lấp đầy khoảng hở 10px của margin
            top: -15px; 
            left: 0;
            width: 100%;
            height: 20px; // Chiều cao 20px là đủ che
            background: transparent; 
            // background: red; // Mẹo: Bật màu đỏ lên để debug xem cầu nối có hiện không, xong thì tắt đi
        }

        a {
            padding: 10px 20px;
            color: $text-secondary;
            text-decoration: none;
            font-size: 0.9rem;
            transition: background 0.2s;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            
            // Bo góc cho thẻ a đầu và cuối để không bị ch chờm ra ngoài glass-panel (thay cho overflow: hidden)
            &:first-child { border-radius: 12px 12px 0 0; }
            &:last-child { border-bottom: none; border-radius: 0 0 12px 12px; }

            &:hover {
                background-color: rgba(255, 255, 255, 0.1);
                color: $text-primary;
            }
        }
}
}

/* --- 3. TOOLBAR --- */
.list-resident-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap; // Cho phép xuống dòng khi màn hình nhỏ
    gap: 15px; // Khoảng cách khi xuống dòng
    margin-bottom: 20px;
    padding: 15px 20px;
    position: relative; 
    z-index: 10;
    @include glass-panel;

    .search-group {
        flex: 1;
        min-width: 250px; // Đảm bảo thanh tìm kiếm không bị bóp quá nhỏ

        position: relative; 
        z-index: 20;
    }

    .action-group {
        display: flex;
        gap: 10px;
        flex-wrap: wrap; // Các nút tự xuống dòng nếu hết chỗ

        button {
            padding: 8px 16px;
            border-radius: 6px;
            border: none;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            white-space: nowrap;

            &.btn-secondary {
                background: rgba(255, 255, 255, 0.1);
                color: $text-primary;
                border: 1px solid rgba(255,255,255,0.1);
                &:hover { background: rgba(255, 255, 255, 0.2); }
            }

            &.btn-primary {
                background: $accent-color;
                color: white;
                box-shadow: 0 4px 10px rgba($accent-color, 0.3);
                &:hover { background: lighten($accent-color, 5%); transform: translateY(-1px); }
            }
        }
    }
}

/* --- 4. BẢNG DỮ LIỆU (FIX TRÀN MÀN HÌNH) --- */
.glass-table, .table-wrapper {
    width: 100%;
    overflow-x: auto; 

    position: relative;
    z-index: 1;
    @include glass-panel; 
    padding: 0;
    margin-bottom: 30px;

    // Scrollbar tùy chỉnh
    &::-webkit-scrollbar { height: 8px; }
    &::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.05); border-radius: 0 0 12px 12px; }
    &::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.2); border-radius: 4px; }

    table {
        width: 100%;
        border-collapse: collapse;
        min-width: 900px; 

        // --- PHẦN TIÊU ĐỀ (THEAD) ---
        thead {
            background-color: rgba(0, 0, 0, 0.25);
            th {
                text-align: left; // Căn trái tiêu đề
                padding: 15px 20px; // Padding trái phải giống td
                color: $text-secondary;
                font-size: 0.8rem;
                text-transform: uppercase;
                font-weight: 700;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                white-space: nowrap;
                
                // Riêng cột cuối cùng (Actions) thì căn phải
                &:last-child {
                    text-align: right; 
                }
            }
        }

        // --- PHẦN DỮ LIỆU (TBODY) ---
        tbody tr {
            transition: background 0.2s;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            &:last-child { border-bottom: none; }
            &:hover { background-color: rgba(255, 255, 255, 0.05); }

            td {
                text-align: left; // QUAN TRỌNG: Căn trái dữ liệu để khớp với tiêu đề
                padding: 12px 20px; // Padding phải bằng padding của th
                font-size: 0.9rem;
                color: rgba(255, 255, 255, 0.9);
                vertical-align: middle;
                white-space: nowrap; 

                // Riêng cột cuối cùng (chứa nút bấm)
                &:last-child {
                    text-align: right;
                    // Nếu dùng flexbox trong action-cell thì cần chỉnh justify-content
                    .action-cell {
                        justify-content: flex-end; 
                    }
                }
            }
        }
    }
}

.action-cell {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    button {
        padding: 6px 12px;
        border-radius: 4px;
        border: none;
        cursor: pointer;
        font-weight: 600;
        font-size: 0.75rem;
        transition: all 0.2s;

        &.edit-btn {
            background: rgba($accent-color, 0.15);
            color: #8da4ff; // Màu sáng hơn chút cho dễ nhìn
            &:hover { background: $accent-color; color: white; }
        }

        &.delete-btn {
            background: rgba($danger-color, 0.15);
            color: $danger-color;
            &:hover { background: $danger-color; color: white; }
        }
    }
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* --- RESPONSIVE MOBILE --- */
@media (max-width: 768px) {
    .resident-page-wrapper { padding: 10px; }
    .list-resident-toolbar { flex-direction: column; align-items: stretch; }
    .search-group, .action-group { width: 100%; }
    .action-group { justify-content: space-between; }
    
    // Trên mobile, bảng sẽ cuộn ngang nhờ overflow-x: auto ở trên
}
